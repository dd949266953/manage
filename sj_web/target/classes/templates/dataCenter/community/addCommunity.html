<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="multipart/form-data; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>添加小区</title>
    <link rel="stylesheet" th:href="@{/layui/css/layui.css}"/>
    <link rel="stylesheet" th:href="@{/css/back_public.css}"/>
    <script th:src="@{/layui/layui.js}" type="text/javascript"></script>
    <script th:src="@{/js/jquery-3.2.1.js}" type="text/javascript"></script>
    <script th:src="@{/js/back_upload.js}"></script>
</head>
<body>
<header th:text="${community.id}==null?'添加小区':'修改小区'"></header>
<section>
    <div class="main" id="layerDemo">
        <form class="layui-form" action="" th:object="${community}" enctype="multipart/form-data">
            <div class="layui-form-item form-item">
                <label class="layui-form-label row lable">
                    <span>*</span>小区名称 :</label>
                <div class="layui-input-block row row-div">
                    <input type="text" name="name" th:value="*{name}" lay-verify="title" autocomplete="off"
                           placeholder="请输入小区名称"
                           class="layui-input input">
                    <div class="verify">表单验证区域</div>
                </div>
            </div>

            <div class="layui-form-item form-item">
                <label class="layui-form-label row lable">
                    <span>*</span>所在地区 :</label>
                <div class="layui-input-block row row-div">
                    <input type="text" name="address" th:value="*{address}" lay-verify="title" autocomplete="off"
                           placeholder="请选择所在地区"
                           class="layui-input input">
                    <div class="verify">表单验证区域</div>
                </div>
            </div>
            <div class="layui-form-item form-item">
                <label class="layui-form-label row lable">
                    <span>*</span>详细地址 :</label>
                <div class="layui-input-block row row-div">
                    <input type="text" name="detailaddress" th:value="*{detailaddress}" lay-verify="title"
                           autocomplete="off" placeholder="请输入详细地址"
                           class="layui-input input">
                    <div class="verify">表单验证区域</div>
                </div>
            </div>
            <div class="layui-form-item form-item">
                <label class="layui-form-label row lable">
                    客服电话 :</label>
                <div class="layui-input-block row row-div">
                    <input type="text" name="servicetel" th:value="*{servicetel}" lay-verify="title" autocomplete="off"
                           placeholder="请输入客服电话"
                           class="layui-input input">
                </div>
            </div>
            <div class="layui-form-item form-item">
                <label class="layui-form-label row lable">
                    负责人 :</label>
                <div class="layui-input-block row row-div">
                    <input type="text" name="leader" th:value="*{leader}" lay-verify="title" autocomplete="off"
                           placeholder="请输入负责人"
                           class="layui-input input">
                </div>
            </div>
            <div class="layui-form-item form-item">
                <label class="layui-form-label row lable">
                    负责人电话 :</label>
                <div class="layui-input-block row row-div">
                    <input type="text" name="leaderphone" th:value="*{leaderphone}" lay-verify="title"
                           autocomplete="off" placeholder="请输入负责人电话"
                           class="layui-input input">
                </div>
            </div>
            <div class="layui-form-item form-item">
                <label class="layui-form-label row lable">
                    小区LOGO :</label>
                <div class="layui-input-block row row-div">
                    <div class="layui-upload img-div" th:data="logo">
                        <div th:class="${community.logo==null||community.logo==''}?'upload-before':'upload-before hide'">
                            <i class="iconfont" style="font-size: 36px;">&#xe602;</i>
                            <p>上传图片</p>
                        </div>
                        <div class="upload-after" style="display: none;">
                            <i class="iconfont look layui-btn laybtn" data-method="offset" style="font-size: 24px;">&#xe61e;</i>
                            <i class="iconfont del" style="font-size: 24px;">&#xe618;</i>
                        </div>
                        <img th:remove="${community.logo==null||community.logo==''}? all : none "
                             th:src="@{'http://localhost:8081/img/upload-img/'+ ${community.logo}}" th:height="86px"
                             th:width="86px">

                    </div>
                </div>
            </div>
            <div class="layui-form-item form-item">
                <label class="layui-form-label row lable">
                    小区背景 :</label>
                <div class="layui-input-block row row-div">
                    <div class="layui-upload img-div" th:data="background">
                        <div th:class="${community.backgroundimage==null ||community.backgroundimage==''}?'upload-before':'upload-before hide'">
                            <i class="iconfont" style="font-size: 36px;">&#xe602;</i>
                            <p>上传图片</p>
                        </div>
                        <div class="upload-after" style="display: none;">
                            <i class="iconfont look layui-btn laybtn" data-method="offset" style="font-size: 24px;">&#xe61e;</i>
                            <i class="iconfont del" style="font-size: 24px;">&#xe618;</i>
                        </div>
                        <img th:remove="${community.backgroundimage==null ||community.backgroundimage==''}? all : none "
                             th:src="@{'http://localhost:8081/img/upload-img/'+ ${community.backgroundimage}}"
                             th:height="86px" th:width="86px">
                    </div>

                </div>
            </div>
        </form>
        <div class="photo"></div>
        <div class="buttondiv">
            <div class="button-item"></div>
            <div class="button-item">
                <button class="layui-btn layui-btn-normal layui-btn-radius  save"
                        th:text="${community.id==null}?'添加':'修改'"></button>
                <button class="layui-btn layui-btn-normal layui-btn-radius ">返回</button>
            </div>
        </div>
    </div>
</section>
<footer>
    Copyright 2013-2018 weixiaoqu.com 成都云联峰创科技有限公司旗下产品
</footer>

<script th:inline="javascript">

    <!--单机保存-->
    $(".save").click(function () {
        if (pass === 1) {
            var logo = getImgName("logo");					//小区logo
            var backgroundimage = getImgName("background");	//小区背景图
            var data = $.param({'logo': logo, 'backgroundimage': backgroundimage}) + '&' + $("form").serialize();
            //获取小区id
            var communityid = [[${community.id}]];
            //提示
            var hint = communityid == null ? "添加" : "修改";
            $.post('/Community/addCommunity', data, function (result) {
                if (result === 1) {
                    layer.msg(hint + "成功", {
                        icon: 1
                    })
                } else {
                    layer.msg(hint + '添加失败', {
                        icon: 2
                    });
                }
            })
        }
    })
</script>
</body>
</html>
